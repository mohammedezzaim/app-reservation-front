<div class="container mt-5">

  <mat-card>
    <mat-card-header>
      <mat-card-title> CRUD VOITURE</mat-card-title>
    </mat-card-header>
    <mat-divider></mat-divider>
    <mat-card-content>

      <p-toolbar [ngStyle]="{'margin': '2rem'}" class="custom-toolbar">
        <div class="p-toolbar-group-left">
          <p-button type="button" (click)="showDialog()" class="mx-2 " label="New" icon="pi pi-plus"></p-button>
          <p-button (click)="exportToPDF()" label="Exporte" icon="pi pi-file-export"
                    styleClass="p-button-success"></p-button>
        </div>

        <div class="p-toolbar-group-right">

          <mat-form-field appearance="outline">
            <mat-label>Search</mat-label>
            <input matInput (change)="search($event)">
          </mat-form-field>
        </div>

      </p-toolbar>
      <div class="table-wrapper">
        <table id="content" matSort mat-table [dataSource]="dataSource" class="mat-elevation-z1 ">

          <ng-container matColumnDef="couleur"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>couleur</th>
            <td mat-cell *matCellDef="let element"> {{ element.couleur }}</td>
          </ng-container>

<!--          (click)="photoByCode(element.code)"-->
          <ng-container matColumnDef="photo">
            <th mat-header-cell *matHeaderCellDef >photo</th>
            <td mat-cell *matCellDef="let element"><i (click)="photoByMatricule(element)" class="bi bi-image" ></i></td>
          </ng-container>


          <ng-container matColumnDef="nbrPlace"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>nbrPlace</th>
            <td mat-cell *matCellDef="let element"> {{ element.nbrPlace }}</td>
          </ng-container>


          <ng-container matColumnDef="matricule"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>matricule</th>
            <td mat-cell *matCellDef="let element"> {{ element.matricule }}</td>
          </ng-container>

          <ng-container matColumnDef="kiloMetrage"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>kiloMetrage</th>
            <td mat-cell *matCellDef="let element"> {{ element.kiloMetrage }}</td>
          </ng-container>

          <ng-container matColumnDef="boitevitesse"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>boitevitesse</th>
            <td mat-cell *matCellDef="let element"> {{ element.boitevitesse }}</td>
          </ng-container>


          <ng-container matColumnDef="annee"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>annee</th>
            <td mat-cell *matCellDef="let element"> {{ element.annee  | date:'dd/mm/yyyy' }}</td>
          </ng-container>


          <ng-container matColumnDef="ville"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ville</th>
            <td mat-cell *matCellDef="let element"> {{ element.ville }}</td>
          </ng-container>


          <ng-container matColumnDef="dateMisecirculation"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>dateMisecirculation</th>
            <td mat-cell *matCellDef="let element"> {{ element.dateMisecirculation  | date:'dd/mm/yyyy' }}</td>
<!--            <td mat-cell *matCellDef="let element"> {{ element.dateMisecirculation  | date:'dd/mm/yyyy HH:mm:ss' }}</td>-->

          </ng-container>


          <ng-container matColumnDef="dateAssurance"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>dateAssurance</th>
            <td mat-cell *matCellDef="let element"> {{ element.dateAssurance  | date:'dd/mm/yyyy'}}</td>
          </ng-container>


          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef>Action</th>
            <td mat-cell *matCellDef="let element">
              <a (click)=editProduct(element)><i class="bi bi-pencil mx-2 btn btn-outline-success rounded-5"></i></a>
              <a><i (click)="handlDelete(element.ville)" class="bi bi-trash mx-2 btn btn-outline-danger rounded-5"></i></a>
            </td>
          </ng-container>


          <ng-container matColumnDef="sateVisitetechnique"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>sateVisitetechnique</th>
            <td mat-cell *matCellDef="let element"> {{ element.sateVisitetechnique   | date:'dd/mm/yyyy'}}</td>
          </ng-container>

          <ng-container matColumnDef="nomModele"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>nomModele</th>
            <td mat-cell *matCellDef="let element"> {{ element.nomModele }}</td>
          </ng-container>

          <ng-container matColumnDef="prix"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Prix</th>
            <td mat-cell *matCellDef="let element"> {{ element.prix }}</td>
          </ng-container>

          <ng-container matColumnDef="puissance"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>puissance</th>
            <td mat-cell *matCellDef="let element"> {{ element.puissance }}</td>
          </ng-container>

          <ng-container matColumnDef="Carburant"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Carburant</th>
            <td mat-cell *matCellDef="let element"> {{ element.Carburant }}</td>
          </ng-container>


          <ng-container matColumnDef="categorie"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>categorie.Libelle</th>
            <td mat-cell *matCellDef="let element"> {{ element.categorie.libelle }}</td>
          </ng-container>

          <ng-container matColumnDef="agenceLocation"> <!-- Utilisation de 'id' au lieu de 'Id' -->
            <th mat-header-cell *matHeaderCellDef mat-sort-header>agenceLocation.iceAgLoc</th>
            <td mat-cell *matCellDef="let element"> {{ element.agenceLocation.iceAgLoc }}</td>
          </ng-container>





          <tr mat-header-row *matHeaderRowDef="ListeColum"></tr>
          <tr mat-row *matRowDef="let row; columns: ListeColum;"></tr>
        </table>
      </div>
      <mat-paginator [pageSizeOptions]="[5, 10, 20]"
                     showFirstLastButtons
                     aria-label="Select page of periodic elements">
      </mat-paginator>

    </mat-card-content>
  </mat-card>

</div>







<p-dialog [maximizable]="true"  [(visible)]="display" [style]="{width: '600px',height:'600px'}" header="Product Details" [modal]="true"
          styleClass="p-fluid">

  <div class=" row field col">

    <div class="col-6">
      <label class="form-label">couleur</label>
      <input class="form-control" type="text" pInputText placeholder="couleur" [(ngModel)]="item.couleur" [value]="selectedVoitureItem.couleur" required autofocus/>
    </div>
    <div class="col-6">
      <label class="form-label">nbrPlace</label>
      <input class="form-control" type="text" pInputText placeholder="nbrPlace" [(ngModel)]="item.nbrPlace" [value]="selectedVoitureItem.nbrPlace" required autofocus/>
    </div>

  </div>


  <div class=" row field col">
    <div class="col-6">
      <label class="form-label">matricule</label>
      <input class="form-control" type="text" pInputText placeholder="matricule" [(ngModel)]="item.matricule" [value]="selectedVoitureItem.matricule" required
             autofocus/>
    </div>

    <div class="col-6">
      <label class="form-label">kiloMetrage</label>
      <input class="form-control" type="text" pInputText placeholder="kiloMetrage" [(ngModel)]="item.kiloMetrage" [value]="selectedVoitureItem.kiloMetrage" required
             autofocus/>
    </div>
  </div>

  <div class=" row field col">
    <div class="col-6">
      <label class="form-label">boitevitesse</label>
      <input class="form-control" type="text" pInputText placeholder="boitevitesse" [(ngModel)]="item.boitevitesse" [value]="selectedVoitureItem.boitevitesse" required
             autofocus/>
    </div>
    <div class="col-6">
      <label class="form-label">annee</label>
      <input class="form-control" type="text" pInputText placeholder="annee" [(ngModel)]="item.annee" [value]="selectedVoitureItem.annee" required autofocus/>
    </div>
  </div>

  <div class=" row field col">
    <div class="col-6">
      <label class="form-label">ville</label>
      <select class="form-select form-select-lg " aria-label=".form-select-lg example"  [(ngModel)]="item.ville" [value]="selectedVoitureItem.ville">
        <option *ngFor="let option of villes" [value]="option">{{ option }}</option>
      </select>
    </div>
    <div class="col-6">
      <label class="form-label">dateMisecirculation</label>
      <input class="form-control" type="date" pInputText placeholder="dateMisecirculation" [(ngModel)]="item.dateMisecirculation" [value]="selectedVoitureItem.dateMisecirculation"
             required autofocus/>
    </div>
  </div>

  <div class=" row field col">
    <div class="col-6">
      <label class="form-label">dateAssurance</label>
      <input class="form-control" type="date" pInputText placeholder="dateAssurance" [(ngModel)]="item.dateAssurance" [value]="selectedVoitureItem.dateAssurance" required
             autofocus/>
    </div>
    <div class="col-6">
      <label class="form-label">sateVisitetechnique</label>
      <input class="form-control" type="date" pInputText placeholder="sateVisitetechnique" [(ngModel)]="item.sateVisitetechnique" [value]="selectedVoitureItem.sateVisitetechnique"
             required autofocus/>
    </div>
  </div>


  <div class="row field col">
    <div class="col-6">
      <label class="form-label">nomModele</label>
      <input class="form-control" type="text" pInputText placeholder="nomModele" [(ngModel)]="item.nomModele" [value]="selectedVoitureItem.nomModele" required
             autofocus/>
    </div>
    <div class="col-6">
      <label class="form-label">prix</label>
      <input class="form-control" type="text" pInputText placeholder="prix" [(ngModel)]="item.prix" [value]="selectedVoitureItem.prix" required autofocus/>
    </div>
  </div>


  <div class=" row field col">
    <div class="col-6">
      <label class="form-label">puissance</label>
      <input class="form-control" type="text" pInputText placeholder="puissance" [(ngModel)]="item.puissance" [value]="selectedVoitureItem.puissance" required
             autofocus/>
    </div>
    <div class="col-6">
      <label class="form-label">Carburant</label>
      <input class="form-control" type="text" pInputText placeholder="Carburant" [(ngModel)]="item.Carburant" [value]="selectedVoitureItem.Carburant" required
             autofocus/>
    </div>
  </div>
  <div class=" row field col">
    <div class="col-6">
      <label class="form-label">categorie</label>
      <select class="form-select form-select-lg " aria-label=".form-select-lg example"  [(ngModel)]="item.categorie.libelle" [value]="selectedVoitureItem.categorie.libelle">
        <option *ngFor="let option of categorie" [value]="option.libelle">{{ option.libelle }}</option>
      </select>
<!--      <input class="form-control" type="text" pInputText placeholder="libelle" [(ngModel)]="item.categorie.libelle" [value]="selectedVoitureItem.categorie.libelle" required  autofocus/>-->
    </div>
  </div>


  <div class="col-12 mt-5" *ngIf="isCreate">
    <div class="dropzone" appDrag (files)="fileDropped($event)"   (click)="selectFile.click()">
      <div class="dropzone-text">
        <div class="center">Drag and drop your file or
          <a class="browser-button" (click)="selectFile.click()">browse</a> a file
        </div>
      </div>
    </div>

    <div>
      <input style="display: none" type="file" multiple value="select" #selectFile (change)="oneFileSelected($event)">
    </div>

    <mat-grid-list cols="6" rowHeight="1:1">
      <mat-grid-tile *ngFor="let file of service.item.images; let i=index;">
        <div style="position: relative" class="mt-5">
          <span class="btn-remove" (click)="removeImages(i)">x</span>
          <img [src]="file.url">
        </div>
      </mat-grid-tile>
    </mat-grid-list>
  </div>



  <ng-template pTemplate="footer">
    <button  pButton pRipple label="Cancel" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
    <button *ngIf="isCreate" pButton pRipple label="Save" icon="pi pi-check" class="p-button-text" (click)="saveObject()"></button>
    <button *ngIf="isEdit" pButton pRipple label="Update" icon="pi pi-check" class="p-button-text" (click)="EditObject()"></button>
  </ng-template>
</p-dialog>


<p-dialog  [maximizable]="true"  [(visible)]="displayImagesByCode" [style]="{width: '900px',height:'900px'}" header="Product Details" [modal]="true" styleClass="p-fluid">
  <p-carousel [value]="images" circular="true" autoplayInterval="3000" >
    <ng-template let-url pTemplate="item">
      <div class="border-1 surface-border border-round m-2 p-3">
        <img [src]="url" class="carousel-image" [alt]="url">
      </div>
    </ng-template>

    <div class="carousel-controls">
      <button pButton type="button" icon="pi pi-chevron-left" class="p-button-secondary p-button-rounded left-button" (click)="prevSlide()"></button>
      <button pButton type="button" icon="pi pi-chevron-right" class="p-button-secondary p-button-rounded right-button" (click)="nextSlide()"></button>
    </div>
  </p-carousel>
</p-dialog>


